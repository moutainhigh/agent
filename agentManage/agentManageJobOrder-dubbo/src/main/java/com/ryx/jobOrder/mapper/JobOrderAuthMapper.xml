<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.ryx.jobOrder.dao.JobOrderAuthMapper">

    <select id="getReqJobOrderAuth" resultType="java.util.Map">
        select cr.*
        from c_resource cr
                 left join c_role_resource crr
                           on cr.id = crr.resource_id
                 left join c_role cro
                           on cro.id = crr.role_id
                 left join c_user_role cur
                           on cur.role_id = cro.id
                 left join c_user cu
                           on cu.id = cur.user_id
        where cro.description like 'Group%' and cr.url is not null
        <if test="userId != null">
                 and cur.user_id = #{userId}
        </if>
    </select>
    <select id="getAcceptCode" resultType="java.util.Map" parameterType="string">
        select cr.*
        from c_role cr
        left join c_role_resource crr
               on crr.role_id = cr.id
        left join c_resource cre
               on cre.id = crr.resource_id
        where cr.status = '0'
          <if test="jobOrderType != null">
              and cre.url = #{jobOrderType}
          </if>
    </select>
    <select id="getAcceptGroup" parameterType="string" resultType="java.util.Map">
        select cro.id, cro.name, cro.description, cur.id
        from c_role cro
        left join c_user_role cur
        on cur.role_id in cro.id
        left join c_user cu
        on cu.id = cur.user_id
        where cro.description like 'Group%'
        <if test="userId != null">
            and cu.id = #{userId}
        </if>
    </select>
    <select id="getAllAcceptGroup" resultType="java.util.Map">
        select cro.id, cro.name, cro.description
        from c_role cro
        where cro.description like 'Group%' and cro.status = 0
    </select>
</mapper>