<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd"><mapper namespace="com.ryx.credit.dao.agent.AgentDebitCardMapper">    <select id="countQuery" resultType="java.lang.Integer">        select count(1) from (          <include refid="queryForList_Detail"/>        ) aaa    </select>    <select id="queryForList" resultType="java.util.Map">        <include refid="OracleDialectPrefix"/>        <include refid="queryForList_Detail"/>        <include refid="OracleDialectSuffix"/>    </select>    <sql id="queryForList_Detail">        select a.ID,a.AG_NAME,a.AG_STATUS,ac.CLO_TYPE,ac.CLO_REALNAME,ac.CLO_BANK_ACCOUNT,        ac.CLO_BANK,ac.CLO_BANK_BRANCH,ac.ALL_LINE_NUM,ac.BRANCH_LINE_NUM,ap.FLAG,ac.SUGGEST_STATUS,ap.ID as PAY_ID,        ac.ID as AC_ID        from A_AGENT a        inner join (            select distinct aa.ID from A_AGENT aa            left join A_AGENT_BUSINFO b on aa.ID = b.AGENT_ID            where  aa.AG_STATUS = 'Approved' and aa.STATUS = 1            and b.CLO_REVIEW_STATUS = '3' and b.STATUS = 1            <if test="map.docPro != null and map.docPro != '' ">                and b.AG_DOC_PRO = #{map.docPro}            </if>            <if test="map.docDis != null and map.docDis != '' ">                and b.AG_DOC_DISTRICT = #{map.docDis}            </if>        ) bb on a.ID = bb.ID        left join (SELECT * FROM(                SELECT z.ID , z.MERCH_ID ,ROW_NUMBER()                OVER(PARTITION BY z.MERCH_ID ORDER BY z.ID desc ) AS code_id                FROM A_COLINFO_PAYMENT z                )                WHERE code_id = 1          ) ddd on a.ID = ddd.MERCH_ID        left join A_AGENT_COLINFO ac on a.ID = ac.AGENT_ID        left join  A_COLINFO_PAYMENT ap on ddd.ID = ap.ID        where  1 = 1        <if test="map.agStatus != null and map.agStatus != '' ">            and  a.AG_STATUS = #{map.agStatus}        </if>        <if test="map.cloType != null and map.cloType != '' ">            and ac.CLO_TYPE = #{map.cloType}        </if>        <if test="map.agentName != null and map.agentName != '' ">            and a.AG_NAME like CONCAT(CONCAT('%',#{map.agentName}),'%')        </if>        <if test="map.agentId != null and map.agentId != '' ">            and a.ID = #{map.agentId}        </if>        <if test="map.cloRealname != null and map.cloRealname != '' ">            and ac.CLO_REALNAME = #{map.cloRealname}        </if>        <if test="map.flag != null and map.flag != '' ">            and ap.FLAG = #{map.flag}        </if>        <if test="map.sugStatus != null and map.sugStatus != '' ">            and ac.SUGGEST_STATUS = #{map.sugStatus}        </if>    </sql>    <select id="getNoticeList" resultType="java.util.Map">        <include refid="OracleDialectPrefix"/>        select a.ID,a.AG_NAME,a.AG_STATUS,ac.CLO_TYPE,ac.CLO_REALNAME,ac.CLO_BANK_ACCOUNT,        ac.CLO_BANK,ac.CLO_BANK_BRANCH,ac.ALL_LINE_NUM,ac.BRANCH_LINE_NUM,ap.FLAG,ac.SUGGEST_STATUS,ap.ID as PAY_ID,        ac.ID as AC_ID        from A_AGENT a        inner join (select distinct AGENT_ID from A_AGENT_BUSINFO where STATUS = 1 and AG_DOC_PRO = #{orgId}) ab on a.ID = ab.AGENT_ID        left join A_AGENT_COLINFO ac on a.ID = ac.AGENT_ID        left join (SELECT * FROM(              SELECT z.FLAG,z.ID,z.MERCH_ID,z.COLINFO_ID,ROW_NUMBER()              OVER(PARTITION BY z.MERCH_ID ORDER BY z.ID desc ) AS code_id                FROM A_COLINFO_PAYMENT z            )WHERE code_id = 1) ap on ac.ID = ap.COLINFO_ID        where  ac.SUGGEST_STATUS = '1'        <include refid="OracleDialectSuffix"/>    </select>    <select id="getNoticeCount" resultType="java.lang.Integer" parameterType="java.lang.String">        select count(1) from (           select a.ID,a.AG_NAME,a.AG_STATUS,ac.CLO_TYPE,ac.CLO_REALNAME,ac.CLO_BANK_ACCOUNT,            ac.CLO_BANK,ac.CLO_BANK_BRANCH,ac.ALL_LINE_NUM,ac.BRANCH_LINE_NUM,ap.FLAG,ac.SUGGEST_STATUS,ap.ID as PAY_ID,            ac.ID as AC_ID            from A_AGENT a            inner join (select distinct AGENT_ID from A_AGENT_BUSINFO where STATUS = 1 and AG_DOC_PRO = #{orgId}) ab on a.ID = ab.AGENT_ID            left join A_AGENT_COLINFO ac on a.ID = ac.AGENT_ID            left join (SELECT * FROM(                SELECT z.FLAG,z.ID,z.MERCH_ID,z.COLINFO_ID,ROW_NUMBER()                OVER(PARTITION BY z.MERCH_ID ORDER BY z.ID desc ) AS code_id                FROM A_COLINFO_PAYMENT z                )                WHERE code_id = 1) ap on ac.ID = ap.COLINFO_ID            where  ac.SUGGEST_STATUS = '1'        ) aaa    </select>    <select id="exports" resultType="java.util.Map">        select a.ID agentId ,a.AG_NAME agentName,ac.CLO_REALNAME cloRealName,ac.CLO_BANK_ACCOUNT cloBankAccount,        ac.CLO_BANK cloBank,ac.CLO_BANK_BRANCH cloBankBranch,ac.ALL_LINE_NUM allLineNum,ac.BRANCH_LINE_NUM branchLineNum,        '审批通过' as agStatus,        case when ap.FLAG = '1' then '已生批'        when ap.FLAG = '0' then '未处理'        when ap.FLAG = '2' then '打款失败-已重试'        when ap.FLAG = '3' then '复合通过'        when ap.FLAG = '4' then '风险拦截'        when ap.FLAG = '5' then '已撤销'        when ap.FLAG = '7' then '复合中'        when ap.FLAG = '8' then '复合不通过'        when ap.FLAG = '9' then '银行处理成功'        when ap.FLAG = '11' then '打款成功'        when ap.FLAG = '12' then '打款失败'        when ap.FLAG = '20' then '银行处理失败'        else '' end as flag ,        case when ac.CLO_TYPE = 2 then '对私' when ac.CLO_TYPE = 1 then '对公' end as cloType        from A_AGENT a        inner join (        select distinct aa.ID from A_AGENT aa        left join A_AGENT_BUSINFO b on aa.ID = b.AGENT_ID        where  aa.AG_STATUS = 'Approved' and aa.STATUS = 1        and b.CLO_REVIEW_STATUS = '3' and b.STATUS = 1        <if test="map.docPro != null and map.docPro != '' ">            and b.AG_DOC_PRO = #{map.docPro}        </if>        <if test="map.docDis != null and map.docDis != '' ">            and b.AG_DOC_DISTRICT = #{map.docDis}        </if>        ) bb on a.ID = bb.ID        left join (SELECT * FROM(        SELECT z.ID , z.MERCH_ID ,ROW_NUMBER()        OVER(PARTITION BY z.MERCH_ID ORDER BY z.ID desc ) AS code_id        FROM A_COLINFO_PAYMENT z        )        WHERE code_id = 1        ) ddd on a.ID = ddd.MERCH_ID        left join A_AGENT_COLINFO ac on a.ID = ac.AGENT_ID        left join  A_COLINFO_PAYMENT ap on ddd.ID = ap.ID        where  1 = 1        <if test="map.agStatus != null and map.agStatus != '' ">            and  a.AG_STATUS = #{map.agStatus}        </if>        <if test="map.cloType != null and map.cloType != '' ">            and ac.CLO_TYPE = #{map.cloType}        </if>        <if test="map.agentName != null and map.agentName != '' ">            and a.AG_NAME like CONCAT(CONCAT('%',#{map.agentName}),'%')        </if>        <if test="map.agentId != null and map.agentId != '' ">            and a.ID = #{map.agentId}        </if>        <if test="map.cloRealname != null and map.cloRealname != '' ">            and ac.CLO_REALNAME = #{map.cloRealname}        </if>        <if test="map.flag != null and map.flag != '' ">            and ap.FLAG = #{map.flag}        </if>        <if test="map.sugStatus != null and map.sugStatus != '' ">            and ac.SUGGEST_STATUS = #{map.sugStatus}        </if>    </select>    <select id="getBusInfoById" parameterType="java.lang.String" resultType="java.util.Map">      select  oor.ORG_NAME as ORGAN_NUM,oo.ORG_NAME as FINACE_REMIT_ORGAN      from A_AGENT_BUSINFO ab      left join o_organization oor on ab.ORGAN_NUM = oor.ORG_ID      left join o_organization oo on ab.FINACE_REMIT_ORGAN = oo.ORG_ID      where ab.AGENT_ID = #{id}    </select>    <update id="updateSuggestStatusById">        update A_AGENT_COLINFO set SUGGEST_STATUS = '${statu}' where ID = '${id}'    </update>    <sql id="OracleDialectPrefix">        <if test="page != null">            select * from ( select row_.*, rownum rownum_ from (        </if>    </sql>    <sql id="OracleDialectSuffix">        <if test="page != null">            <![CDATA[ ) row_ ) where rownum_ > #{page.begin} and rownum_ <= #{page.end} ]]>        </if>    </sql></mapper>